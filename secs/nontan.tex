\begin{defn}
  Dati $\alpha \in (0,\pi/2)$ e $\sigma \in \partial\mathbb{D}$, chiamiamo \textit{settore di vertice $\sigma$ e angolo $2\alpha$} l'insieme $S(\sigma,\alpha) \subset \mathbb{D}$ tale che per ogni $z \in S(\sigma,\alpha)$ l'angolo compreso tra la retta congiungente $\sigma$ e $0$ e la retta congiungente $\sigma$ e $z$ è minore di $\alpha$.
  \begin{center}
    \begin{tikzpicture}[line cap=round,line join=round,>=triangle 45,x=2.5cm,y=2.5cm]
      \draw[->,color=black] (-1.13,0) -- (1.15,0);
      \foreach \x in {-1,1}
      \draw[shift={(\x,0)},color=black] (0pt,2pt) -- (0pt,-2pt);
      \draw[->,color=black] (0,-1.11) -- (0,1.12);
      \foreach \y in {-1,1}
      \draw[shift={(0,\y)},color=black] (2pt,0pt) -- (-2pt,0pt);
      \clip(-1.13,-1.11) rectangle (1.15,1.12);
      \draw(0,0) circle (2.5cm);
      \draw[name path=A] (0.49,0.87)-- (1,0);
      \draw[name path=B] (0.49,-0.87)-- (1,0);
      \tikzfillbetween[of=A and B]{blue, opacity=0.25};
      \draw[name path=C,smooth,samples=100,domain=-1:0.491] plot(\x,{sqrt(1-(\x)^2)});
      \draw[name path=D,smooth,samples=100,domain=-1:0.491] plot(\x,{0-sqrt(1-(\x)^2)});
      \tikzfillbetween[of=C and D]{blue, opacity=0.25};
    \end{tikzpicture}

    In blu, il settore $S(1,2\pi/3)$
  \end{center}
\end{defn}

\begin{defn}
  Dati $\sigma \in \partial \mathbb{D}$ e $M>1$, chiamiamo \textit{regione di Stolz $K(\sigma,M)$} l'insieme $\left\{z \in \mathbb{D} \mid \dfrac{|\sigma-z|}{1-|z|} < M\right\}$.
  \begin{center}
    \begin{tikzpicture}[line cap=round,line join=round,>=triangle 45,x=2.5cm,y=2.5cm]
      \draw[->,color=black] (-1.16,0) -- (1.18,0);
      \foreach \x in {-1,1}
      \draw[shift={(\x,0)},color=black] (0pt,2pt) -- (0pt,-2pt);
      \draw[->,color=black] (0,-1.13) -- (0,1.15);
      \foreach \y in {-1,1}
      \draw[shift={(0,\y)},color=black] (2pt,0pt) -- (-2pt,0pt);
      \clip(-1.16,-1.13) rectangle (1.18,1.15);
      \draw(0,0) circle (2.5cm);
      \draw[name path=A, smooth,samples=100,domain=-0.1715705740864879:1] plot(\x,{sqrt(7-4*sqrt(3-2*(\x))-2*(\x)-(\x)^2)});
      \draw[name path=B, smooth,samples=100,domain=-0.1715705740864879:1] plot(\x,{0-sqrt(7-4*sqrt(3-2*(\x))-2*(\x)-(\x)^2)});
      \tikzfillbetween[of=A and B]{red, opacity=0.25};
    \end{tikzpicture}

    In rosso, la regione di Stolz $K(1,2)$
  \end{center}
\end{defn}

\begin{prop} \label{settori-stolz}
  Dato $M>1$, sia $\alpha=\text{\normalfont{arctan}}\sqrt{M^2-1} \in (0,\pi/2)$. Per ogni $\alpha'<\alpha$ esiste $\epsilon>0$ tale che, detto $B(\sigma,\epsilon)=\{z \in \mathbb{C} \mid |\sigma-z|<\epsilon\}$, si ha
  $$S(\sigma,\alpha')\cap B(\sigma,\epsilon) \subset K(\sigma,M) \subset S(\sigma,\alpha).$$
\end{prop}

\begin{proof}
  Per definizione, $S(\sigma,\alpha)$ corrisponde all'insieme $S(1,\alpha)$ ruotato moltiplicando per $\sigma$. Lo stesso vale per $K(\sigma,M)$: infatti, $\dfrac{|\sigma-z|}{1-|z|}=\dfrac{|1-\sigma^{-1}z|}{1-|\sigma^{-1}z|}$. Possiamo dunque supporre senza perdita di generalità $\sigma=1$. È utile osservare che in questo caso $S(1,\alpha)=\left\{z \in \mathbb{D} \mid |\mathfrak{Im}(z)|<\tan{\alpha}\bigl(1-\mathfrak{Re}(z)\bigr)\right\}$.

  Mostriamo la seconda inclusione. Poiché $1>|z|>\mathfrak{Re}(z)$, abbiamo
  \begin{gather*}
    M>\frac{|1-z|}{1-|z|}\ge \frac{|1-z|}{1-\mathfrak{Re}(z)} \\
    M^2-1 > \frac{|1-z|^2}{\bigl(1-\mathfrak{Re}(z)\bigr)^2}-1 \\
    M^2-1 > \frac{(1-z)(1-\bar{z})}{\bigl(1-\mathfrak{Re}(z)\bigr)^2}-1 \\
    M^2-1 > \frac{1-2\mathfrak{Re}(z)+|z|^2}{\bigl(1-\mathfrak{Re}(z)\bigr)^2}-1 \\
    M^2-1 > \frac{|\mathfrak{Im}(z)|^2}{\bigl(1-\mathfrak{Re}(z)\bigr)^2} \\
    \frac{|\mathfrak{Im}(z)|}{1-\mathfrak{Re}(z)}<\sqrt{M^2-1}=\tan{\alpha}.
  \end{gather*}

  Mostriamo adesso la prima inclusione. Fissiamo $\alpha'<\alpha$. Supponiamo per assurdo che, per ogni $\epsilon>0$, esista $z \in S(1,\alpha')\cap B(1,\epsilon)$ tale che $z \not\in K(1,M)$. Per tali $z$ si ha allora $\dfrac{|1-z|}{1-|z|} \ge M \implies \dfrac{1-|z|}{|1-z|} \overset{(\star)}{\le} \dfrac{1}{M}$ e
  \begin{gather*}
    \frac{|\mathfrak{Im}(z)|}{1-\mathfrak{Re}(z)}<\tan{\alpha'} \\
    \frac{|\mathfrak{Im}(z)|^2}{\bigl(1-\mathfrak{Re}(z)\bigr)^2}+1<\tan^2{\alpha'}+1 \\
    \frac{1-2\mathfrak{Re}(z)+|z|^2}{\bigl(1-\mathfrak{Re}(z)\bigr)^2}<\tan^2{\alpha'}+1 \\
    \frac{|1-z|^2}{\bigl(1-\mathfrak{Re}(z)\bigr)^2}<\tan^2{\alpha'}+1 \\
    \frac{|1-z|}{1-\mathfrak{Re}(z)}<\sqrt{\tan^2{\alpha'}+1}=M' \, (\star\star)
  \end{gather*}
  dove $\alpha'<\alpha \implies \tan{\alpha'}<\tan{\alpha} \implies M'<M$. Moltiplicando tra loro le disuguaglianze $(\star)$ e $(\star\star)$ troviamo $\dfrac{1-|z|}{1-\mathfrak{Re}(z)}<\dfrac{M'}{M}<1$.
  Se mostriamo che $\displaystyle \lim_{\substack{z \longrightarrow 1, \\ z \in S(1,\alpha')}} \frac{1-|z|}{1-\mathfrak{Re}(z)}=1$ avremo trovato una contraddizione. Scrivendo $x=\mathfrak{Re}(z)$ e $y=\mathfrak{Im}(z)$ e supponendo senza perdita di generalità $y>0$, la condizione $z \in S(1,\alpha')$ si scrive come $y/(1-x)<\tan{\alpha'}$. Inoltre vale che
  \begin{align*}
    \frac{1-|z|}{1-\mathfrak{Re}(z)} &=\frac{1-\sqrt{x^2+y^2}}{1-x} \\
    & =1-\frac{\sqrt{x^2+y^2}-x}{1-x}.
  \end{align*}
  Notiamo che $\dfrac{\sqrt{x^2+y^2}-x}{1-x}>0$, dunque per mostrare che tende a $0$ ci basta osservare che
  \begin{align*}
    \frac{\sqrt{x^2+y^2}-x}{1-x} & < \tan{\alpha'}\cdot\frac{\sqrt{x^2+y^2}-x}{y} \\
    & =\tan{\alpha'}\cdot\frac{\sqrt{x^2+y^2}-x}{y}\cdot\frac{\sqrt{x^2+y^2}+x}{\sqrt{x^2+y^2}+x} \\
    & =\tan{\alpha'}\cdot\frac{y^2}{y(\sqrt{x^2+y^2}+x)} \\
    & =\tan{\alpha'}\cdot\frac{y}{\sqrt{x^2+y^2}+x}
  \end{align*}
  e quest'ultima espressione tende a $0$ per $x \longrightarrow 1$ e $y \longrightarrow 0$.
\end{proof}

\begin{defn}
  Diciamo che una funzione $f:\mathbb{D} \longrightarrow \mathbb{C}$ ha \textit{limite non-tangenziale} $L \in \mathbb{C}$ in $\sigma \in \partial\mathbb{D}$ e scriviamo
  $$\substack{\text{nt--lim} \\ z \longrightarrow \sigma} \, f(z)=L$$
  se  per ogni $M>1$ si ha $\displaystyle \lim_{\substack{z \longrightarrow \sigma, \\ z \in K(\sigma,M)}} f(z)=L$.

  Date altre due funzioni $g,h: \mathbb{D} \longrightarrow \mathbb{C}$ scriviamo che $f(z)=g(z)+o\bigl(h(z)\bigr)$ per $z \longrightarrow \sigma$ \textit{non tangenzialmente} se
  $$\substack{\text{nt--lim} \\ z \longrightarrow \sigma} \, \frac{f(z)-g(z)}{h(z)}=0.$$
\end{defn}

La seguente proposizione asserisce che, per $z \longrightarrow 1$ non tangenzialmente, un certo andamento di $f$ può essere tradotto nell'andamento di $|f^h|$. È questo che ci permetterà di dimostrare il teorema 2.1 di \cite{BK} passando per la versione al bordo del lemma di Schwarz-Pick.

\begin{prop} \label{o^3->o^2}
  Siano $f \in \text{\normalfont{Hol}}(\mathbb{D},\mathbb{D})$ e $\sigma \in \partial\mathbb{D}$ tali che
  \begin{equation} \label{o^3}
    f(z)=\sigma+(z-\sigma)+o\bigl((z-\sigma)^3\bigr)
  \end{equation}
  per $z \longrightarrow \sigma$ non tangenzialmente. Allora
  \begin{equation} \label{o^2}
    |f^h(z)|=1+o\bigl((z-\sigma)^2\bigr)
  \end{equation}
  per $z \longrightarrow \sigma$ non tangenzialmente.
\end{prop}

\begin{proof}
  A meno di considerare $g(z)=\sigma^{-1}f(\sigma z)$, possiamo supporre senza perdita di generalità $\sigma=1$. Infatti, è facile verificare che nell'ipotesi \eqref{o^3} si ha $g(z)=1+(z-1)+o\bigl((z-1)^3\bigr)$. Se inoltre avessimo $|g^h(z)|=1+o\bigl((z-1)^2\bigr)$, poiché vale
  \begin{align*}
    |g^h(z)| & =|g'(z)|\frac{1-|z|^2}{1-|g(z)|^2} \\
    & =|f'(\sigma z)|\frac{1-|z|^2}{1-|\sigma^{-1}f(\sigma z)|^2} \\
    & =|f'(\sigma z)|\frac{1-|\sigma z|^2}{1-|f(\sigma z)|^2} \\
    & =|f^h(\sigma z)|
  \end{align*}
  e mediante la sostituzione $\zeta=\sigma z$ si ha
  $$o\bigl((z-1)^2\bigr)=o\bigl(\sigma^{-2}(\zeta-\sigma)^2\bigr)=o\bigl((\zeta-\sigma)^2\bigr)$$
  e ovviamente $|f^h(\sigma z)|=|f^h(\zeta)|$, troviamo l'equazione \eqref{o^2} con $\zeta$ al posto di $z$.

  Sia $M>1$ e consideriamo $z \in K(1,M)$. Allora per la Proposizione \ref{settori-stolz} si ha $z \in S(1,\alpha)$ dove $\alpha=\text{arctan}\sqrt{M^2-1}$.
  Sia inoltre $\beta \in (0,\pi/2)$ con $\beta>\alpha$ e sia $C(z)$ il cerchio di centro $z$ e raggio $r(z)=\text{dist}\bigl(z, \partial S(1,\beta)\bigr)$, la distanza euclidea di $z$ dal bordo di $S(1,\beta)$. Allora per la formula integrale di Cauchy
  \begin{align*}
    f'(z) & =\frac{1}{2\pi i} \int_{C(z)} \frac{f(w)}{(w-z)^2}\diff w \\
    & =\frac{1}{2\pi i} \int_{C(z)} \frac{w-1+(f(w)-w)}{(w-z)^2}\diff w \\
    & =\frac{1}{2\pi i} \int_{C(z)} \frac{1}{w-z}\diff w+\frac{1}{2\pi i} \int_{C(z)} \frac{z-1+f(w)-w}{(w-z)^2}\diff w \\
    & =1+\frac{1}{2\pi i} \int_{C(z)} \frac{f(w)-w}{(w-z)^2}\diff w=:1+I(z).
  \end{align*}

  \begin{center}
    \definecolor{qqffqq}{rgb}{0,1,0}
    \definecolor{qqqqff}{rgb}{0,0,1}
    \definecolor{uququq}{rgb}{0.25,0.25,0.25}
    \definecolor{ffqqqq}{rgb}{1,0,0}
    \begin{tikzpicture}[line cap=round,line join=round,>=triangle 45,x=3.0cm,y=3.0cm]
      \draw[->,color=black] (-1.12,0) -- (1.2,0);
      \foreach \x in {-1,1}
      \draw[shift={(\x,0)},color=black] (0pt,2pt) -- (0pt,-2pt);
      \draw[->,color=black] (0,-1.11) -- (0,1.11);
      \foreach \y in {-1,1}
      \draw[shift={(0,\y)},color=black] (2pt,0pt) -- (-2pt,0pt);
      \clip(-1.12,-1.11) rectangle (1.2,1.11);
      \draw [shift={(1,0)},color=ffqqqq,fill=ffqqqq,fill opacity=0.1] (0,0) -- (180:0.26) arc (180:244.77:0.26) -- cycle;
      \draw [shift={(1,0)},color=qqqqff,fill=qqqqff,fill opacity=0.1] (0,0) -- (-180:0.14) arc (-180:-127.09:0.14) -- cycle;
      \draw [shift={(1,0)},color=qqffqq,fill=qqffqq,fill opacity=0.1] (0,0) -- (115.23:0.33) arc (115.23:143.3:0.33) -- cycle;
      \draw(0,0) circle (3cm);
      \draw (1,0)-- (0.27,0.96);
      \draw (0.64,0.77)-- (1,0);
      \draw (0.27,-0.96)-- (1,0);
      \draw (1,0)-- (0.64,-0.77);
      \draw [shift={(1,0)},color=ffqqqq] (180:0.26) arc (180:244.77:0.26);
      \draw [shift={(1,0)},color=ffqqqq] (180:0.23) arc (180:244.77:0.23);
      \draw(0.5,0.37) circle (0.888cm);
      \draw (0.5,0.37)-- (0.77,0.49);
      \draw (0.27,0.54)-- (1,0);
      \draw [shift={(1,0)},color=qqffqq] (115.23:0.33) arc (115.23:143.3:0.33);
      \draw [shift={(1,0)},color=qqffqq] (115.23:0.3) arc (115.23:143.3:0.3);
      \draw [shift={(1,0)},color=qqffqq] (115.23:0.28) arc (115.23:143.3:0.28);
      \begin{scriptsize}
        \draw[color=ffqqqq] (0.84,-0.09) node {$\beta$};
        \fill [color=black] (0.5,0.37) circle (1.5pt);
        \draw[color=black] (0.48,0.32) node {$z$};
        \draw[color=black] (0.18,0.14) node {$C(z)$};
        \draw[color=black] (0.54,0.465) node {$r(z)$};
        \fill [color=black] (1,0) circle (1.5pt);
        \draw[color=black] (1.04,0.05) node {$1$};
        \fill [color=black] (0.26,0.545) circle (1.5pt);
        \draw[color=black] (0.20,0.58) node {$A$};
        \fill [color=black] (1,0) circle (1.5pt);
        \draw[color=qqqqff] (0.92,-0.03) node {$\alpha$};
        \draw[color=qqffqq] (0.83,0.16) node {$\gamma$};
      \end{scriptsize}
    \end{tikzpicture}
  \end{center}

  Per la Proposizione \ref{settori-stolz} esiste $\delta>0$ tale che, se $w \in S(1,\beta) \cap B(1,\delta)$, si ha $w \in K(1,M')$ con $M'>\sqrt{\tan^2\beta+1}$.
  Dato $\epsilon>0$ fissato e prendendo $\delta$ sufficientemente piccolo, per ipotesi abbiamo che $|f(w)-w|<\epsilon|1-w|^3$ per ogni $w \in K(1,M') \cap B(1,\delta)$ e di conseguenza per ogni $w \in S(1,\beta) \cap B(1,\delta)$.
  Poiché $S(1,\beta) \subset \mathbb{D}$, dev'essere $r(z) \le \text{dist}(z,\mathbb{D})=1-|z|$. Si ha anche $1-|z| \le |1-z|$, quindi prendendo $z \in B(1,\delta/2)$ abbiamo $r(z) \le |z-1|<\delta/2$. Dunque per ogni $w \in C(z)$ troviamo che $|w-1| \le |w-z|+|z-1|=r(z)+|z-1|<\delta$. Per questi $z$ vale che
  \begin{align*}
    |I(z)| & \le \frac{\epsilon}{2\pi} \int_0^{2\pi} \frac{|1-(z+r(z)e^{i\theta})|^3}{|(z+r(z)e^{i\theta})-z|^2}r(z)\diff\theta \\
    & \le \frac{\epsilon}{r(z)}\max_{\theta \in [0,2\pi]} |1-(z+r(z)e^{i\theta})|^3 \\
    & =\frac{\epsilon}{r(z)}\max_{w \in C(z)}|1-w|^3.
  \end{align*}
  Il massimo è raggiunto per l'intersezione più lontana da $1$ tra la circonferenza $C(z)$ e la retta passante per $1$ e $z$ (il punto $A$ in figura). Perciò, detto $\gamma$ l'angolo tra la retta congiungente $1$ e $z$ e il tratto affine di $\partial S(1,\beta)$ più vicino a $z$ (che è effettivamente il tratto di bordo più vicino a $z$ se lo si prende sufficientemente vicino a $1$), si ha
  \begin{align*}
    |I(z)| & \le \frac{\epsilon}{r(z)}\bigl(r(z)+|z-1|\bigr)^3 \\
    & =\epsilon r(z)^2\left(1+\frac{|z-1|}{r(z)}\right)^3 \\
    & =\epsilon r(z)^2(1+\csc\gamma)^3 \\
    & \le \epsilon r(z)^2\bigl(1+\csc(\beta-\alpha)\bigr)^3 \\
    & \le \epsilon |z-1|^2\bigl(1+\csc(\beta-\alpha)\bigr)^3.
  \end{align*}
  La penultima disuguaglianza segue da $\gamma \ge \beta-\alpha$ e dal fatto che $\csc$ è decrescente sui positivi, mentre l'ultima segue da quanto visto sopra. Otteniamo dunque $f'(z)=1+o\bigl((z-1)^2\bigr)$ per $z \longrightarrow 1$ non tangenzialmente.

  Notiamo che all'interno della regione di Stolz $K(1,M)$ si ha $1 \le \dfrac{|z-1|}{1-|z|} \le M$, il che ci  permette di usare indipendentemente $z-1$ o $1-|z|$ negli $o$-piccoli per $z \longrightarrow 1$ non tangenzialmente. Per ipotesi
  $$\frac{1-|f(z)|}{1-|z|}=\frac{1-|z|+o\bigl((z-1)^3\bigr)}{1-|z|}=1+o\bigl((z-1)^2\bigr)$$
  per $z \longrightarrow 1$ non tangenzialmente. Possiamo quindi concludere che
  $$|f^h(z)|=|f'(z)|\frac{1-|z|^2}{1-|f(z)|^2}=1+o\bigl((z-1)^2\bigr)$$
  per $z \longrightarrow 1$ non tangenzialmente.
\end{proof}
