\begin{defn}
  Sia $\Omega \subset \mathbb{C}$ un aperto. Una funzione $f:\Omega \longrightarrow \mathbb{C}$ si dice \textit{olomorfa} in $\Omega$ se è derivabile in senso complesso per ogni $z \in \Omega$, e scriviamo $f \in \mathcal{O}(\Omega)$. Se $\Ima(f) \subset \Omega'$ scriviamo $f \in \text{Hol}(\Omega, \Omega')$.
\end{defn}

\begin{defn}
  Se $f \in \text{Hol}(\Omega, \Omega)$ è biettiva, allora si può dimostrare che anche $f^{-1}$ è olomorfa. In tal caso $f$ è detta \textit{automorfismo} (in senso olomorfo) di $\Omega$ e scriviamo $f \in \text{Aut}(\Omega)$.
\end{defn}

Com'è noto, la condizione di olomorfia per funzioni a valori complessi è molto più forte della derivabilità in senso reale (in particolare, è equivalente all'analiticità). Fra i vari risultati noti per le funzioni olomorfe, ci interessa studiare il lemma di Schwarz-Pick, fino a dimostrarne una versione al bordo.

Notazione: indichiamo il disco unitario con $\mathbb{D}:=\{z \in \mathbb{C} \mid |z|<1\}$. Riportiamo ora alcuni risultati noti di analisi complessa che verranno usati nelle dimostrazioni.

\begin{thm}
  (formula integrale di Cauchy, \cite[Chapter 1.3, Theorems 9 and 10]{NN}) Sia $f \in \mathcal{O}(\Omega)$ e $D$ un disco chiuso di centro $a$ contenuto in $\Omega$. Allora per ogni $n \in \mathbb{N}$ si ha
  \begin{equation}
    f^{(n)}(a)=\frac{n!}{2\pi i} \int_{\partial D} \frac{f(\zeta)}{(\zeta-a)^{n+1}}\diff\zeta.
  \end{equation}
\end{thm}

\begin{prop} \label{estensione}
  (teorema di estensione di Riemann, \cite[Chapter 1.5, Theorem 2]{NN}) Sia $f \in \mathcal{O}(\Omega \setminus\{z_0\})$ con $z_0 \in \Omega$. Allora $f$ si estende a una $g \in \mathcal{O}(\Omega)$ se e solo se è limitata in un intorno di $z_0$. In tal caso, $z_0$ è detta \normalfont{singolarità rimovibile}.
\end{prop}

\begin{prop}
  (principio del massimo per funzioni olomorfe, \cite[Chapter 1.3, Corollary of Theorem 3 and Theorem 5]{NN}) Sia $\Omega \subset \mathbb{C}$ un aperto e sia $f \in \mathcal{O}(\Omega)$. Sia inoltre $U$ un aperto relativamente compatto in $\Omega$, cioè $\overline{U} \subset \Omega$ e $\overline{U}$ compatto. Allora per ogni $z \in U$ si ha
  $$|f(z)| \le \sup_{w \in \partial U} |f(w)|$$
  e vale l'uguale per qualche $z \in U$ solo se $f$ è costante sulla componente connessa di $U$ contenente $z$.
\end{prop}

Vediamo adesso i lemmi di Schwarz e Schwarz-Pick.

\begin{lm}
  (lemma di Schwarz) Sia $f \in \text{\normalfont{Hol}}(\mathbb{D},\mathbb{D})$ tale che $f(0)=0$. Allora per ogni $z \in \mathbb{D}$ si ha $|f(z)| \le |z|$ e $|f'(0)| \le 1$; inoltre, se vale l'uguaglianza nella prima per $z_0 \not=0$ oppure nella seconda allora $f(z)=e^{i\theta}z$ per qualche $\theta \in \mathbb{R}$.
\end{lm}

\begin{proof}
  Poiché $f(0)=0$, possiamo costruire $g \in \mathcal{O}(\mathbb{D})$ con $g(z)=\frac{f(z)}{z}$ estendendola per continuità in $0$ come $g(0)=f'(0)$. Fissiamo $0<r<1$.
  Per ogni $z \in \mathbb{D}$ tale che $|z| \le r$, per il principio del massimo per funzioni olomorfe si ha
  $$|g(z)| \le \max_{|w|=r} |g(w)|=\max_{|w|=r} \frac{|f(w)|}{r} \le \frac{1}{r}.$$
  Mandando $r$ a $1$ otteniamo che per ogni $z \in \mathbb{D}$ si ha $|g(z)| \le 1$, da cui $|f(z)|\le |z|$ e $|f'(0)| \le 1$.

  Se vale una delle due ugaglianze, allora esiste $z_0 \in \mathbb{D}$ tale che $|g(z_0)|=1$. Dunque, sempre per il principio del massimo $g$ è costantemente uguale a un valore di modulo $1$ in ogni disco di centro l'origine e raggio $|z_0|<r<1$, quindi su $\mathbb{D}$. Perciò $g(z)=e^{i\theta}$ con $\theta \in \mathbb{R}$, da cui $f(z)=e^{i\theta}z$.
\end{proof}

\begin{cor} \label{cor_schw}
  Se $f \in \text{\normalfont{Aut}}(\mathbb{D})$ è tale che $f(0)=0$, allora $f(z)=e^{i\theta}z$.
\end{cor}

\begin{proof}
  Se $f \in \text{Aut}(\mathbb{D})$ anche $f^{-1} \in \text{Aut}(\mathbb{D})$; inoltre $(f^{-1})'(0)=\dfrac{1}{f'(0)}$. Per il lemma di Schwarz, $|f'(0)| \le 1$ e $|(f^{-1})'(0)| \le 1$; dunque $|f'(0)|=1$, da cui la tesi sempre per il lemma di Schwarz.
\end{proof}

\begin{defn}
  Diciamo che un gruppo $G$ \textit{agisce fedelmente} su uno spazio $X$ se per ogni $g \in G$ è data una bigezione $\gamma_g:X \longrightarrow X$ tale che $\gamma_{e}=\id$ e $\gamma_{g_1} \circ \gamma_{g_2} =\gamma_{g_1g_2}$, inoltre $\gamma_{g_1}=\gamma_{g_2}$ se e solo se $g_1=g_2$.

  Chiamiamo inoltre \textit{gruppo di isotropia} di $x_0 \in X$ il sottogruppo di $G$ dato da $G_{x_0}=\{g \in G \mid \gamma_g(x_0)=x_0\}$.
\end{defn}

\begin{lm} \label{az_gr}
  Sia $G$ un gruppo che agisce fedelmente su uno spazio $X$ e sia $G_{x_0}$ il gruppo di isotropia di $x_0 \in X$. Supponiamo che per ogni $x \in X$ esista $g_x \in G$ tale che $\gamma_{g_x}(x)=x_0$ e sia $\Gamma=\{g_x \mid x \in X\}$.
  Allora $G$ è generato da $\Gamma$ e $G_{x_0}$, cioè ogni $g \in G$ è della forma $g=hg_x$ con $x \in X$ e $h \in G_{x_0}$.
\end{lm}

\begin{proof}
  Sia $g \in G$ e $x=\gamma_{g^{-1}}(x_0)$. Allora $(\gamma_{g_x}\circ \gamma_{g^{-1}})(x_0)=x_0$ da cui $\gamma_{g_x}\circ \gamma_{g^{-1}}=\gamma_{g_xg^{-1}}=\gamma_h$ con $h \in G_{x_0}$,
  dunque $g_xg^{-1}=h$ e quindi $g=h^{-1}g_x$ con $h^{-1} \in G_{x_0}$.
\end{proof}

\begin{prop} \label{aut}
  Si ha che $f \in \text{\normalfont{Aut}}(\mathbb{D})$ se e solo se esistono $\theta \in \mathbb{R}$ e $a \in \mathbb{D}$ tali che $f(z)=e^{i\theta}\dfrac{z-a}{1-\bar{a}z}$.
\end{prop}

\begin{proof}
  ($\Leftarrow$) Sia $f$ come nell'enunciato. Con semplici conti possiamo vedere che per $z,w \in \mathbb{C}$ con $\bar{w}z\not=1$ si ha
  \begin{equation} \label{formuletta}
    1-\left|\frac{z-w}{1-\bar{w}z}\right|^2=\frac{(1-|w|^2)(1-|z|^2)}{|1-\bar{w}z|^2},
  \end{equation}
  da cui segue che se $a, z \in \mathbb{D}$ allora
  $$1-|f(z)|^2=\frac{(1-|a|^2)(1-|z|^2)}{|1-\bar{a}z|^2}>0,$$
  per cui $|f(z)|<1$, cioè $f(z) \in \mathbb{D}$. L'inversa è $f^{-1}(z)=e^{-i\theta}\dfrac{z+ae^{i\theta}}{z+\bar{a}e^{-i\theta}z}$, della stessa forma. Si noti che $f(a)=0$.

  ($\implies$) Scriviamo per semplicità $f_{a, \theta}(z)=e^{i\theta}\dfrac{z-a}{1-\bar{a}z}$. Vediamo $\text{Aut}(\mathbb{D})$ come gruppo che agisce su $\mathbb{D}$. $\text{Aut}(\mathbb{D})_0$ è, per il Corollario \ref{cor_schw}, $\{f_{0, \theta} \mid \theta \in \mathbb{R}\}$,
  mentre possiamo prendere $\Gamma=\{f_{a, 0} \mid a \in \mathbb{D}\}$ poiché $f_{a, 0}(a)=0$.
  Per il Lemma \ref{az_gr}, $\text{Aut}(\mathbb{D})$ è generato da $\text{Aut}(\mathbb{D})_0$ e $\Gamma$, cioè ogni $\gamma \in \text{Aut}(\mathbb{D})$ è della forma $\gamma=f_{0, \theta} \circ f_{a, 0}=f_{a, \theta}$.
\end{proof}

\begin{oss} \label{dom}
  Dalla dimostrazione abbiamo anche che $f(\partial \mathbb{D}) \subset \partial \mathbb{D}$; inoltre, per $|z|>1$ con $z \not=1/\bar{a}$ si ha $|f(z)|>1$.
\end{oss}

\begin{oss} \label{transi}
  $\text{Aut}(\mathbb{D})$ agisce in modo transitivo su $\mathbb{D}$, cioè si ha che per ogni $z_0, z_1 \in \mathbb{D}$ esiste $\gamma \in \text{Aut}(\mathbb{D})$ tale che $\gamma(z_0)=z_1$. Infatti, basta prendere $\gamma=f_{z_1, 0}^{-1} \circ f_{z_0, 0}$.
\end{oss}

\begin{lm} \label{SP}
  (lemma di Schwarz-Pick) Sia $f \in \text{\normalfont{Hol}}(\mathbb{D},\mathbb{D})$.
  Allora per ogni $z, w \in \mathbb{D}$ si ha
  $$\left|\frac{f(z)-f(w)}{1-\overline{f(w)}f(z)}\right| \le \left|\frac{z-w}{1-\bar{w}z}\right| \text{ e } \frac{|f'(z)|}{1-|f(z)|^2} \le \frac{1}{1-|z|^2}.$$
  Inoltre se vale l'uguaglianza nella prima per $z_0, w_0$ con $z_0 \not=w_0$ o nella seconda per $z_0$ allora $f \in \text{\normalfont{Aut}}(\mathbb{D})$ e vale sempre l'uguaglianza.
\end{lm}

\begin{proof}
  Fissato $w \in \mathbb{D}$ siano $\gamma_1(z)=\dfrac{z+w}{1+\bar{w}z}$ e $\gamma_2(z)=\dfrac{z-f(w)}{1-\overline{f(w)}z}$. Si ha $\gamma_1, \gamma_2 \in \text{Aut}(\mathbb{D})$. Si ha anche che $\gamma_1(0)=w$ e $\gamma_2\bigl(f(w)\bigr)=0$; inoltre $\gamma_1^{-1}(z)=\dfrac{z-w}{1-\bar{w}z}$.
  Per il lemma di Schwarz applicato a $\gamma_2 \circ f \circ \gamma_1$ abbiamo che per ogni $\zeta \in \mathbb{D}$ si ha $|(\gamma_2 \circ f \circ \gamma_1)(\zeta)| \le |\zeta|$; prendendo $\zeta=\gamma_1^{-1}(z)$ otteniamo che per ogni $z \in \mathbb{D}$ si ha $|(\gamma_2 \circ f)(z)| \le |\gamma_1^{-1}(z)|$, che è la prima disuguaglianza.
  Abbiamo poi $|(\gamma_2 \circ f \circ \gamma_1)'(0)| \le 1$, da cui $|\gamma_2'\bigl(f(w)\bigr)f'(w)\gamma_1'(0)| \le 1$. Valgono le seguenti uguaglianze:
  \begin{gather*}
    \gamma_1'(z)=\frac{1+\bar{w}z-\bar{w}(z+w)}{(1+\bar{w}z)^2} \implies \gamma_1'(0)=1-|w|^2, \\
    \gamma_2'(z)=\frac{1-\overline{f(w)}z+\overline{f(w)}\bigl(z-f(w)\bigr)}{\bigl(1-\overline{f(w)}z\bigr)^2} \implies \gamma_2'\bigl(f(w)\bigr)=\dfrac{1}{1-|f(w)|^2}.
  \end{gather*}
  Sostituendo si ottiene la seconda disuguaglianza con $w$ al posto di $z$.

  Per l'uguaglianza, nel primo caso avremmo $|(\gamma_2 \circ f \circ \gamma_1)(\zeta)|=|\zeta|$, mentre nel secondo $|(\gamma_2\circ f\circ\gamma_1)'(0)|=1$. In entrambi i casi, per il lemma di Schwarz $\gamma_2 \circ f \circ \gamma_1=g \in \text{Aut}(\mathbb{D})$, dunque $f=\gamma_2^{-1}\circ g \circ \gamma_1^{-1} \in \text{Aut}(\mathbb{D})$.
\end{proof}

\begin{defn}
  Scriviamo $[z,w]:=f_{w,0}(z)$ e $p(z,w):=|[z,w]|$.
\end{defn}

\begin{oss} \label{muu}
  Se $f$ è un automorfismo del disco, esiste $\mu \in \partial \mathbb{D}$ tale che $[f(z),f(w)]=\mu[z,w]$. Infatti, la funzione $g(\zeta)=[\zeta,f(w)]$ sta in $\text{Aut}(\mathbb{D})$ e $[f(z),f(w)]=g\bigl(f(z)\bigr)$ è ancora un automorfismo. Si ha inoltre $[f(w),f(w)]=0$, dunque dev'essere proprio della forma $\mu[z,w]$ con $|\mu|=1$.
\end{oss}

Dal lemma di Schwarz-Pick abbiamo che la quantità $p(z,w)$ è contratta da $f \in \text{Hol}(\mathbb{D}, \mathbb{D})$. Vediamo adesso una distanza costruita a partire da questa quantità, con la quale dimostreremo una serie di disuguaglianze che ci permetteranno di dimostrare la disuguaglianza di Golusin, dalla quale seguirà la versione al bordo del lemma.

 Consideriamo $\omega(z,w):=\text{arctanh}\bigl(p(z,w)\bigr)=\dfrac{1}{2}\log\left(\dfrac{1+p(z,w)}{1-p(z,w)}\right)$.

\begin{prop} \label{eunadistanza}
  La funzione $\omega: \mathbb{D}\times \mathbb{D} \longrightarrow [0,+\infty)$ è ben definita ed è effettivamente una distanza.
\end{prop}

\begin{proof}
  Notiamo che per $z,w \in \mathbb{D}$ l'equazione \eqref{formuletta} ci dà immediatamente $p(z,w)<1$, per cui $\omega$ è ben definita e resta solo da mostrare che è una distanza.

  L'unica cosa non ovvia da dimostrare è la disuguaglianza triangolare. Applicando la tangente iperbolica a entrambi i membri della disuguaglianza triangolare per $\omega$ e sfruttando l'uguaglianza $\text{tanh}\,(a+b)=\frac{\text{tanh}\,(a)+\text{tanh}\,(b)}{1+\text{tanh}\,(a)\,\text{tanh}\,(b)}$ si ha
  \begin{align*}
    \text{tanh}\bigl(\omega(z_1,z_2)\bigr) & \le \text{tanh}\bigl(\omega(z_1, z_0)+\omega(z_0,z_2)\bigr) \\
    &=\frac{\text{tanh}\bigl(\omega(z_1, z_0)\bigr)+\text{tanh}\bigl(\omega(z_0,z_2)\bigr)}{1+\text{tanh}\bigl(\omega(z_1, z_0)\bigr)\text{tanh}\bigl(\omega(z_0,z_2)\bigr)};
  \end{align*}
  dalla definizione di $\omega$ troviamo
  \begin{equation}
    p(z_1,z_2) \le \frac{p(z_1,z_0)+p(z_0,z_2)}{1+p(z_1,z_0)p(z_0,z_2)}. \label{star}
  \end{equation}
  Notiamo che per il lemma di Schwarz-Pick abbiamo che $p$ è invariante sotto l'azione di $\text{Aut}(\mathbb{D})$. Grazie all'Osservazione \ref{transi}, possiamo dunque supporre senza perdita di generalità che $z_0=0$. Dato che $|1-\bar{z}_2z_1| \le 1+|z_1||z_2|$ e $1-|z_1|^2, 1-|z_2|^2>0$, ricordando l'equazione \eqref{formuletta}, per ogni $z_1, z_2 \in \mathbb{D}$ si ha che
  \begin{align*}
    1-\left|\frac{z_1-z_2}{1-\bar{z}_1z_2}\right|^2 & =\frac{(1-|z_1|^2)(1-|z_2|^2)}{|1-\bar{z}_1z_2|^2} \\
    & \ge \frac{(1-|z_1|^2)(1-|z_2|^2)}{(1+|z_1||z_2|)^2}=1-\left(\frac{|z_1|+|z_2|}{1+|z_1||z_2|}\right)^2,
  \end{align*}
  da cui
  $$\frac{|z_1-z_2|}{|1-\bar{z}_2z_1|} \le \frac{|z_1|+|z_2|}{1+|z_1||z_2|},$$
  che è quello che otteniamo inserendo $z_0=0$ nella disuguaglianza \eqref{star} e usando che $p(0,z)=|z|$.
\end{proof}

\begin{defn}
  La funzione $\omega:\mathbb{D}\times \mathbb{D} \longrightarrow [0,+\infty)$ è detta \textit{distanza di Poincaré (o iperbolica)} del disco.
\end{defn}

\begin{defn}
  Data $f \in \text{Hol}(\mathbb{D},\mathbb{D})$, la \textit{derivata iperbolica} è definita come
  $$f^h(w):=\lim_{z \longrightarrow w} \frac{[f(z),f(w)]}{[z,w]}=\frac{f'(w)(1-|w|^2)}{1-|f(w)|^2},$$
  mentre il \textit{rapporto iperbolico} è definito come
  $$f^*(z,w):=\begin{cases}
    \frac{[f(z),f(w)]}{[z,w]} & \mbox{per }z\not=w \\
    f^h(w) & \mbox{per }z=w.
  \end{cases}$$
\end{defn}

Notiamo che, poiché il limite di $f^*(z,w)$ per $z \longrightarrow w$ è ben definito per ogni $w$, per la Proposizione \ref{estensione} abbiamo che la funzione $f^*(z,w)$ è olomorfa in $z \in \mathbb{D}$ per ogni $w \in \mathbb{D}$ fissato.

\begin{oss} \label{oss1}
  \begin{nlist}
    \item Le disuguaglianze del lemma di Schwarz-Pick possono essere riscritte come $|f^*(z,w)| \le 1$, con uguaglianza se e solo se $f \in \text{Aut}(\mathbb{D})$;
    \item  un altro modo di scrivere le disuguaglianze del lemma di Schwarz-Pick è $p\bigl(f(z),f(w)\bigr) \le p(z,w)$, che è equivalente a $\omega\bigl(f(z),f(w)\bigr) \le \omega(z,w)$ in quanto $\text{arctanh}$ è strettamente crescente;
    \item $p(z,0)=|z|$, quindi $\omega(z,0)=\omega(|z|,0)$; analogamente, $\omega(0,z)=\omega(0,|z|)$;
    \item per definizione, $|f^*(z,w)|=|f^*(w,z)|$.
  \end{nlist}
  Questi risultati verranno usati nelle varie dimostrazioni e verranno esplicitati solo quando ciò che ne segue non è immediato.
\end{oss}

Per trattare i casi estremali delle disuguaglianze in \cite{BM}, ci servirà qualche risultato di tipo geometrico sul disco con la distanza iperbolica.

\begin{defn}
  Una \textit{geodetica} per $\omega$ è una curva $\sigma: \mathbb{R} \longrightarrow \mathbb{D}$ tale che per ogni $t_1,t_2 \in \mathbb{R}$ si ha $\omega\bigl(\sigma(t_1),\sigma(t_2)\bigr)=|t_1-t_2|$.

  Diciamo che tre punti $z_1, z_2, z_3$ appartengono \textit{nell'ordine} alla stessa geodetica se $z_j=\sigma(t_j)$ con $t_1 \le t_2 \le t_3$.
\end{defn}

\begin{oss} \label{geoingeo}
  Poiché $\omega$ è invariante sotto l'azione di $\text{Aut}(\mathbb{D})$, gli automorfismi mandano geodetiche in geodetiche; inoltre, conservano l'ordine.
\end{oss}

\begin{ex} \label{diam}
  Dato $z_0 \in \mathbb{D}$, la curva $\sigma(t)=\tanh(t)\frac{z_0}{|z_0|}$ (il diametro passante per $z_0$) è una geodetica. Che sia il diametro indicato segue dal fatto che la funzione $\tanh:\mathbb{R} \longrightarrow (-1,1)$ è biettiva. Che sia una geodetica segue dalla definizione di $\omega$, dalla formula già citata per $\tanh(a+b)$ e dal fatto che $\tanh$ è dispari.
\end{ex}

\begin{oss}
  Dati due punti $z_0$ e $z_1$, esiste sempre una geodetica passante per entrambi. Infatti, per l'Osservazione \ref{geoingeo} e per transitività di $\text{Aut}(\mathbb{D})$ possiamo supporre $z_1=0$; basta dunque prendere il diametro visto nell'Esempio \ref{diam}.
\end{oss}

\begin{lm} \label{nellordine}
  $z_1,z_2,z_3 \in \mathbb{D}$ appartengono nell'ordine alla stessa geodetica se e solo se $\omega(z_1,z_3)=\omega(z_1,z_2)+\omega(z_2,z_3)$.
\end{lm}

\begin{proof}
  Se appartengono nell'ordine alla stessa geodetica, l'uguaglianza segue dalla definizione.

  Supponiamo ora che valga $\omega(z_1,z_3)=\omega(z_1,z_2)+\omega(z_2,z_3)$. Per transitività di $\text{Aut}(\mathbb{D})$ possiamo supporre $z_2=0$. Usando la definizione di $\omega$, l'uguaglianza si riscrive come
  $$\text{arctanh}\left|\frac{z_1-z_3}{1-\bar{z}_3z_1}\right|=\text{arctanh}|z_1|+\text{arctanh}|z_3|;$$
  applicando la tangente iperbolica a entrambi i membri e usando ancora una volta la formula $\tanh(a+b)=\frac{\tanh(a)+\tanh(b)}{1+\tanh(a)\tanh(b)}$, otteniamo
  $$\left|\frac{z_1-z_3}{1-\bar{z}_3z_1}\right|=\frac{|z_1|+|z_3|}{1+|z_1||z_3|}.$$
  Nella dimostrazione della Proposizione \ref{eunadistanza} abbiamo visto una disuguaglianza che coinvolge le stesse quantità; ripercorrendo i passaggi, si trova che la condizione per l'uguaglianza è $|1-\bar{z}_3z_1|=1+|z_3||z_1|$. Ma questo dice proprio che $z_1$ e $z_3$ stanno sullo stesso diametro, da parti opposte rispetto a $0$.
\end{proof}
